<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="https://azizmalloul.com/images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://azizmalloul.com/images/favicon.ico" type="image/x-icon">

    <title>Arrosage Automatique Intelligent ‚Äì Double ESP32 | Aziz Malloul</title>

    <meta name="description" content="Syst√®me d‚Äôarrosage multizone : double ESP32 (TFT tactile + web s√©curis√©), RTC DS3231, FreeRTOS, journalisation Google Sheets, programmation horaire, cycles ON/OFF et contr√¥le local/distant." />

    <meta name="keywords" content="Aziz Malloul, Projet arrosage automatique, projet personnels, esp32, page web, Contr√¥le a distance, electrovannes, KiCad, √âlectronique, rtc module, ecran tft, joystick, relais, transistors, resistances, photocopleur, diode">

    <meta name="author" content="Aziz Malloul">

    <link rel="canonical" href="https://azizmalloul.com/arrosage_automatique/" />

    <meta property="og:title" content="Arrosage Automatique Intelligent ‚Äì Double ESP32" />
    <meta property="og:description" content="Interface TFT tactile + interface web s√©curis√©e, RTC, logs vers Google Sheets, autonomie compl√®te." />
    <meta property="og:url" content="https://azizmalloul.com/arrosage_automatique/">
		<meta property="og:image" content="https://azizmalloul.com/images/projets_realises/arrosage_automatique/pcb11.jpg">
    <meta property="og:type" content="website">


    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Arrosage Automatique Intelligent ‚Äì Double ESP32 | Aziz Malloul">
    <meta name="twitter:description" content="Interface TFT tactile + web s√©curis√©, RTC DS3231, FreeRTOS, Google Sheets, plannings et contr√¥le local/distant.">
    <meta name="twitter:image" content="https://azizmalloul.com/images/projets_realises/arrosage_automatique/pcb11.jpg">

    <link rel="stylesheet" href="../css/arrosage_automatique.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({ pageLanguage: 'fr' }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</head>

<body oncontextmenu="gtag('event', 'clic_droit', {
    event_category: 'interaction_sensible',
    event_label: 'Clic droit sur la page Arrosage Automatique'
}); return true;">


    <div id="cookie-overlay" class="cookie-overlay hidden"></div>


    <div class="cookie-box">
        <h2>Nous accordons une grande importance √† ta confidentialit√©</h2>
        <div class="scroll-text">
            Ce site utilise des cookies afin d‚Äôoptimiser votre exp√©rience de navigation. En cliquant sur ‚ÄúTout accepter‚Äù, vous consentez √† l‚Äôutilisation de cookies √† des fins de performance, d‚Äôanalyse statistique et d‚Äôaffichage personnalis√©. Pour en savoir plus, veuillez consulter notre
            <a href="../confidentialite/">politique de confidentialit√©</a>
        </div>
        <div class="cookie-actions">
            <button id="accept-all">Tout accepter</button>
            <button id="reject-non-essential">Rejeter les cookies non essentiels</button>
        </div>
    </div>

    <div>
			<header>
				<!-- Menu desktop -->
				<div class="desktop-header">
					<nav>
						<ul>
							<li><a href="../Accueil/">Accueil</a></li>
							<li><a href="../parcours_universitaire/">Parcours Acad√©mique</a></li>
							<li><a href="../projets_r√©alis√©s/" aria-current="page">Projets R√©alis√©s</a></li>
							<li><a href="../mes_diplomes/">Mes Dipl√¥mes</a></li>
							<li><a href="../cv/">CV</a></li>
							<li><a href="../Qui_suis_je/">Qui suis-je ?</a></li>
							<li><a href="../Loisirs/">Loisirs</a></li>
							<li><a href="../contact/">Contact</a></li>
							<li><a href="../espace_interactif/">Espace Interactif</a></li>
							<li id="google_translate_element"></li>
						</ul>
					</nav>
				</div>

				<!-- Menu mobile -->
				<div class="mobile-header">
					<span class="logo">Aziz Malloul</span>
					<div class="hamburger" id="hamburger-menu"><i class="fas fa-bars"></i></div>
				</div>
				<nav id="mobile-nav">
					<ul>
						<li><a href="../Accueil/">Accueil</a></li>
						<li><a href="../parcours_universitaire/">Parcours Acad√©mique</a></li>
						<li><a href="../projets_r√©alis√©s/">Projets R√©alis√©s</a></li>
						<li><a href="../mes_diplomes/">Mes Dipl√¥mes</a></li>
						<li><a href="../cv/">CV</a></li>
						<li><a href="../Qui_suis_je/">Qui suis-je ?</a></li>
						<li><a href="../Loisirs/">Loisirs</a></li>
						<li><a href="../contact/">Contact</a></li>
						<li><a href="../espace_interactif/">Espace Interactif</a></li>
						<li id="google_translate_element_mobile"></li>
					</ul>
				</nav>
			</header>

			<!-- ====== CONTENU PROJET ====== -->
			<section class="projet-details">
				<h1></h1>

				<h1 class="page-title">
					üåø Projet d‚ÄôArrosage Automatique Intelligent ‚Äì Double ESP32
					<img src="../images/projets_realises/arrosage_automatique/logo_berber_fleur.webp" alt="" class="title-logo" aria-hidden="true">
				</h1>


				<div class="lead">
					<strong>Objectif :</strong> syst√®me multizone autonome et connect√©, avec <b>U2 (ESP32-A)</b> pour l‚Äôinterface locale
					<em>TFT tactile + joystick</em> & configuration Wi-Fi, et <b>U1 (ESP32-B)</b> pour piloter
					<em>jusqu‚Äô√† 14 √©lectrovannes</em>, servir une <em>interface Web s√©curis√©e</em>, synchroniser l‚Äôheure
					<em>NTP + RTC DS3231</em>, ex√©cuter les <em>plannings</em> et <em>journaliser vers Google Sheets</em>.
				</div>

				<!-- Vid√©o -->
				<figure class="media">
					<div class="videobox">
						<video controls playsinline preload="metadata"
									poster="../images/projets_realises/arrosage_automatique/arrosage1.webp">
							<source src="../images/projets_realises/arrosage_automatique/video_arrosage.mp4" type="video/mp4">
							Votre navigateur ne prend pas en charge la vid√©o HTML5.
						</video>
					</div>
					<figcaption>D√©monstration&nbsp;: syst√®me d‚Äôarrosage en fonctionnement</figcaption>

				</figure>


				<!-- Sommaire -->
				<nav class="toc-pro" aria-label="Plan de la page">
					<span class="toc-heading"><i class="fa-solid fa-list-check"></i> Plan de la page</span>
					<ul class="toc-links">
						<li><a href="#archi"><i class="fa-solid fa-diagram-project"></i> Architecture g√©n√©rale</a></li>
						<li><a href="#esp32b"><i class="fa-solid fa-wifi"></i> ESP32-B (web & arrosage)</a></li>
						<li><a href="#pins-b"><i class="fa-solid fa-microchip"></i> Broches ESP32-B</a></li>
						<li><a href="#esp32a"><i class="fa-solid fa-display"></i> ESP32-A (TFT & joystick)</a></li>
						<li><a href="#pins-a"><i class="fa-solid fa-microchip"></i> Broches ESP32-A</a></li>
						<li><a href="#modes"><i class="fa-solid fa-droplet"></i> Modes & vannes</a></li>
						<li><a href="#rtos"><i class="fa-solid fa-layer-group"></i> FreeRTOS</a></li>
						<li><a href="#persist"><i class="fa-regular fa-floppy-disk"></i> Persistance</a></li>
						<li><a href="#remote"><i class="fa-solid fa-cloud-arrow-down"></i> Commandes distantes</a></li>
						<li><a href="#logs"><i class="fa-solid fa-table"></i> Journalisation</a></li>
						<li><a href="#galerie"><i class="fa-regular fa-images"></i> Galerie</a></li>
					</ul>
				</nav>


				<h2 id="archi" class="anchor-target"> Architecture g√©n√©rale ‚Äì Double ESP32 (38 pins)</h2>
				<div class="table-wrap">
					<table class="specs">
						<thead><tr><th>Module</th><th>R√¥le</th><th>D√©tails</th></tr></thead>
						<tbody>
							<tr>
								<td><strong>ESP32-A (U2) ‚Äì Interface</strong></td>
								<td>Affichage &amp; saisie locale</td>
								<td>√âcran TFT SPI ILI9341 240√ó320 + tactile XPT2046, joystick (X/Y/SW), portail AP ‚ÄúESP32-Config‚Äù (192.168.4.1)
										pour saisir SSID/PASS, envoi √† U1 via UART, affichage des programmes/√©tats re√ßus d‚ÄôU1.</td>
							</tr>
							<tr>
								<td><strong>ESP32-B (U1) ‚Äì Arrosage &amp; Web</strong></td>
								<td>Pilotage / r√©seau</td>
								<td>Serveur HTTP local s√©curis√©, 14 √©lectrovannes, RTC DS3231 (I2C), NTP, FreeRTOS, persistance,
										journalisation Google Sheets, lecture p√©riodique de <code>command.txt</code> et synchro UART avec U2.</td>
							</tr>
						</tbody>
					</table>
				</div>

				<h2 id="esp32b" class="anchor-target"> ESP32-B : Web s√©curis√©, 14 √©lectrovannes, RTC &amp; NTP</h2>
				<ul>
					<li><strong>Wi-Fi</strong> : connexion au r√©seau domestique (SSID/PASS re√ßus d‚ÄôU2). Interface web locale (port 80) prot√©g√©e.</li>
					<li><strong>RTC DS3231 + NTP</strong> : UTC+2 ; resynchronisation toutes les 24 h ; fonctionnement offline via RTC.</li>
					<li><strong>Plannings par vanne</strong> : d√©but/fin, jours (L‚ÜíD), cycles ON/OFF, manuel/auto.</li>
					<li><strong>Journalisation</strong> : envoi POST vers Google Apps Script ‚Üí Google Sheets (vanne, heure, origine).</li>
				</ul>

				<h3 id="pins-b" class="anchor-target"> Affectation des broches ‚Äì ESP32-B</h3>
				<div class="table-wrap">
					<table class="pins">
						<thead><tr><th>Fonction</th><th>GPIO</th><th>Notes</th></tr></thead>
						<tbody>
							<tr><td>√âlectrovannes (14 sorties)</td><td>4,5,13,14,16,17,18,19,23,25,26,27,32,33</td><td>Bjt/relais (alims s√©par√©es, GND commun)</td></tr>
							<tr><td>I2C ‚Äì RTC DS3231</td><td>21 (SDA), 22 (SCL)</td><td>Horloge temps r√©el</td></tr>
							<tr><td>UART inter-ESP</td><td>12 (RX), 15 (TX)</td><td>Liaison mat√©rielle avec U2</td></tr>
						</tbody>
					</table>
				</div>

				<h2 id="esp32a" class="anchor-target"> ESP32-A : Interface locale TFT tactile + joystick</h2>
				<ul>
					<li><strong>TFT ILI9341</strong> (SPI) + <strong>tactile XPT2046</strong> (SPI partag√©).</li>
					<li><strong>Joystick</strong> : X/Y analogiques + bouton SW.</li>
					<li><strong>Pages</strong> : s√©lection vanne, plages horaires, jours, cycles ON/OFF, ON/OFF/Enregistrer, IP locale de U1.</li>
					<li><strong>Donn√©es re√ßues</strong> d‚ÄôU1 via UART : programmes, √©tats, heure RTC/NTP, logs.</li>
				</ul>

				<h3 id="pins-a" class="anchor-target"> Broches utilis√©es ‚Äì ESP32-A</h3>
				<div class="table-wrap">
					<table class="pins">
						<thead><tr><th>Sous-syst√®me</th><th>GPIO</th><th>R√¥le</th></tr></thead>
						<tbody>
							<tr><td>TFT ILI9341</td><td>14 (CS), 4 (RESET), 2 (DC), 23 (MOSI), 18 (SCK)</td><td>Affichage SPI 240√ó320</td></tr>
							<tr><td>Tactile XPT2046</td><td>5 (T_CS), 18 (T_CLK), 23 (T_DIN), 19 (T_DO), 27 (T_IRQ)</td><td>SPI partag√©</td></tr>
							<tr><td>Joystick</td><td>34 (X), 35 (Y), 25 (SW)</td><td>Navigation + s√©lection</td></tr>
							<tr><td>UART vers U1</td><td>15 (TX), 12 (RX)</td><td>Synchronisation / commandes</td></tr>
						</tbody>
					</table>
				</div>

				<h2 id="modes" class="anchor-target"> Gestion des √©lectrovannes &amp; modes</h2>
				<ul>
					<li><strong>Jusqu‚Äô√† 14 vannes</strong> ind√©pendantes.</li>
					<li><strong>Programmation</strong> : d√©but/fin, d√©lai, jours actifs, ON/OFF, manuel/auto.</li>
					<li><strong>Commandes</strong> :
						<ul>
							<li><em>Manuel</em> : interface web s√©curis√©e ou interface locale.</li>
							<li><em>Automatique</em> : horaires persistants + lecture p√©riodique de <code>command.txt</code> + synchro UART.</li>
						</ul>
					</li>
				</ul>

				<h2 id="rtos" class="anchor-target"> Multit√¢che FreeRTOS (ESP32-B)</h2>
				<div class="table-wrap">
					<table class="specs">
						<thead><tr><th>T√¢che</th><th>Description</th></tr></thead>
						<tbody>
							<tr><td><code>ArrosageTask</code></td><td>V√©rifie chaque seconde horaires &amp; cycles ON/OFF, applique timeouts.</td></tr>
							<tr><td><code>TimeDisplayTask</code></td><td>Affiche l‚Äôheure RTC/NTP en continu (console / web).</td></tr>
						</tbody>
					</table>
				</div>

				<h2 id="persist" class="anchor-target"> Stockage &amp; persistance (conservation des donn√©es apr√®s red√©marrage)</h2>
				<ul>
					<li><strong>ESP32-B / Preferences</strong> : param√®tres par vanne (d√©but/fin, cycle, jours, √©tat).</li>
					<li><strong>ESP32-A / EEPROM</strong> : dernier planning s√©lectionn√© c√¥t√© interface.</li>
				</ul>

				<h2 id="remote" class="anchor-target"> Commandes distantes via Internet</h2>
				<ul>
					<li><strong>ON1 ‚Üí</strong> : Allume la vanne 1 imm√©diatement.</li>
					<li><strong>OFF1 ‚Üí</strong> : √âteint la vanne 1 imm√©diatement.</li>
					<li><strong>SET2;06:00:00;06:10:00;60;1,3,5 ‚Üí</strong> : Programme la vanne 2 (6h-6h10, cycle 60 s, jours Lundi, Mercredi, Vendredi).</li>
				</ul>

				<h2 id="logs" class="anchor-target"> Journalisation vers Google Sheets</h2>
				<ul>
					<li>Google Apps Script + Google Sheets.</li>
					<li>Action, vanne, horodatage, origine (Web, tactile, auto, distante).</li>
					<li>Page <em>journal.html</em> (alwaysdata) pour visualiser les logs.</li>
				</ul>

				<h2 id="galerie" class="anchor-target">Galerie ‚Äì Rendus &amp; PCB</h2>

				<div class="gallery-grid">
					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/pcb1.webp" alt="Vue de face - 3D (KiCad)" loading="lazy" decoding="async">
						</div>
						<figcaption>Vue de face - 3D (KiCad)</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/pcb2.webp" alt="Vue arri√®re - 3D (KiCad)" loading="lazy" decoding="async">
						</div>
						<figcaption>Vue arri√®re - 3D (KiCad)</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/pcb.webp" alt="Routage de la carte (KiCad)" loading="lazy" decoding="async">
						</div>
						<figcaption>Routage de la carte (KiCad)</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/schema.webp" alt="Schema de la carte" loading="lazy" decoding="async">
						</div>
						<figcaption>Schema de la carte</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/arrosage1.webp" alt="Prototype d‚Äôarrosage, relais actifs, controle depuis l‚Äôinterface web sur smartphone" loading="lazy" decoding="async">
						</div>
						<figcaption>Prototype d‚Äôarrosage : relais actifs, contr√¥le via interface web (smartphone)</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/arrosage2.webp" alt="√âcran TFT affichant l‚Äôadresse IP locale de l‚ÄôESP32, carte relais et smartphone" loading="lazy" decoding="async">
						</div>
						<figcaption>Affichage de l‚Äôadresse IP locale sur l‚Äô√©cran TFT (acc√®s √† l‚Äôinterface web)</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/arrosage3.webp" alt="Contr√¥le de l‚Äô√©lectrovanne 2 via l‚Äôinterface TFT ; carte relais et console web visibles" loading="lazy" decoding="async">
						</div>
						<figcaption>Commande en temps r√©el de l‚Äô√©lectrovanne 2 depuis l‚Äô√©cran TFT</figcaption>
					</figure>

					<figure class="card">
						<div class="thumb">
							<img src="../images/projets_realises/arrosage_automatique/electrovanne.webp" alt="Electrovanne" loading="lazy" decoding="async">
						</div>
						<figcaption>√âlectrovanne</figcaption>
					</figure>
				</div>

			<footer>
				<p>&copy; 2024 - Aziz Malloul. Tous droits r√©serv√©s.</p>
			</footer>
		</div>

		<script src="../js/scripts.js"></script>
		<script src="../js/cookies.js"></script>
	</body>
	</html>